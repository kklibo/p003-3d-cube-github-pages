<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Spinning Cube with Rust + WebAssembly</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>3D Spinning Cube</h1>
        <p class="description">Rendered with Rust + WebAssembly + WebGL</p>
        
        <div class="canvas-container">
            <canvas id="cube-canvas"></canvas>
            <div id="error-container">
                <p id="error-message"></p>
            </div>
        </div>
        
        <div class="controls">
            <button id="stop-button">Stop Animation</button>
            <button id="start-button">Start Animation</button>
        </div>
        
        <footer>
            <p>
                Built with 
                <a href="https://www.rust-lang.org/" target="_blank">Rust</a>, 
                <a href="https://webassembly.org/" target="_blank">WebAssembly</a>, and
                <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API" target="_blank">WebGL</a>
            </p>
            <p>
                <a href="https://github.com/yourusername/p003-3d-cube-github-pages" target="_blank">View Source on GitHub</a>
            </p>
        </footer>
    </div>

    <script type="module">
        import init, { Cube } from './pkg/p003_3d_cube_github_pages.js';

        // Make the cube accessible globally for debugging
        window.myCube = null;

        // Resize canvas to match display size
        function resizeCanvasToDisplaySize(canvas) {
            const displayWidth = canvas.clientWidth;
            const displayHeight = canvas.clientHeight;
            
            if (canvas.width !== displayWidth || canvas.height !== displayHeight) {
                canvas.width = displayWidth;
                canvas.height = displayHeight;
                console.log(`Canvas resized to ${displayWidth}x${displayHeight}`);
            }
        }

        // Initialize and start the cube
        async function initializeCube() {
            try {
                console.log("Loading WebAssembly module...");
                await init();
                console.log("WebAssembly module loaded successfully");
                
                const canvas = document.getElementById('cube-canvas');
                resizeCanvasToDisplaySize(canvas);
                
                console.log("Creating cube instance...");
                const cube = new Cube('cube-canvas');
                window.myCube = cube;
                
                console.log("Starting cube animation...");
                cube.start();
                
                // Set up control buttons
                document.getElementById('stop-button').addEventListener('click', () => {
                    console.log("Stop button clicked");
                    cube.stop();
                });
                
                document.getElementById('start-button').addEventListener('click', () => {
                    console.log("Start button clicked");
                    cube.start();
                });
                
                // Handle window resize
                window.addEventListener('resize', () => {
                    resizeCanvasToDisplaySize(canvas);
                });
                
                console.log("Initialization complete");
            } catch (e) {
                console.error("Error initializing application:", e);
                document.getElementById('error-message').textContent = 
                    `Error: ${e.message}. Try using a different browser or updating your graphics drivers.`;
                document.getElementById('error-container').style.display = 'flex';
            }
        }

        // Start everything when the page is fully loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeCube);
        } else {
            // If DOMContentLoaded already fired
            initializeCube();
        }
    </script>
</body>
</html> 